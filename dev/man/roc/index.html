<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ROC · ROCKS.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DaymondLing.github.io/ROCKS.jl/stable/man/roc/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ROCKS.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">User&#39;s Guide</span><ul><li><a class="tocitem" href="../kstest/">KS Test</a></li><li class="is-active"><a class="tocitem" href>ROC</a><ul class="internal"><li><a class="tocitem" href="#Example"><span>Example</span></a></li><li><a class="tocitem" href="#Concordance"><span>Concordance</span></a></li><li><a class="tocitem" href="#Fixed-width-tied-region"><span>Fixed width tied region</span></a></li><li><a class="tocitem" href="#Percentage-tied-range"><span>Percentage tied range</span></a></li></ul></li><li><a class="tocitem" href="../bcdiag/">Plots and Tables</a></li></ul></li><li><a class="tocitem" href="../../Reference/">Function Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User&#39;s Guide</a></li><li class="is-active"><a href>ROC</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>ROC</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/DaymondLing/ROCKS.jl/blob/master/docs/src/man/roc.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="ROC"><a class="docs-heading-anchor" href="#ROC">ROC</a><a id="ROC-1"></a><a class="docs-heading-anchor-permalink" href="#ROC" title="Permalink"></a></h1><p>A good binary classifier should have high sensitivity (able to recognize True Positive, low False Negative) and high specificity (able to recognize True Negatives, low False Positive). A plot of the trade-off curve of True Positive Rate versus False Positive Rate at various cutoff probabilities is called the Receiver Operating Characteristic (ROC) curve. One way to quantify performance is by the area under the ROC curve, often abbreviated as AUC or C.</p><p>AUC is in the range [0, 1], a perfect model has AUC of 1, a random model has AUC of 0.5, and a perfectly backwards model would have AUC of -1.</p><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>Create data:</p><pre><code class="language-julia">using ROCKS
using Random
using Distributions

Random.seed!(888)
const x = rand(Uniform(-5, 5), 1_000_000)
const logit = -3.0 .+ 0.5 .* x .+ rand(Normal(0, 0.1), length(x))
const prob = @. 1.0 / (1.0 + exp(-logit))
const target = rand(length(x)) .&lt;= prob</code></pre><p>Now compute roc:</p><pre><code class="language-julia">roc(target, prob)</code></pre><pre class="documenter-example-output">(conc = 69434969897, tied = 392052, disc = 15985130195, auc = 0.8128630985401923, gini = 0.6257261970803847)</pre><p><code>auc</code> is the area under ROC curve.</p><h2 id="Concordance"><a class="docs-heading-anchor" href="#Concordance">Concordance</a><a id="Concordance-1"></a><a class="docs-heading-anchor-permalink" href="#Concordance" title="Permalink"></a></h2><p>Many packages compute AUC via numeric integration of area under the ROC curve. There is another interpretation of AUC which provides more intuition than simply as the area under a curve.</p><p>If we make all possible pair-wise comparisons between the probabilities of class 1 with class 0, we can count the incidences of:</p><ul><li>Concordant: class 1 probability &gt; class 0 probability</li><li>Tied: class 1 probability ≈ class 0 probability</li><li>Discordant: class 1 probability &lt; class 0 probability</li></ul><p>We can then compute the following metrics:</p><ul><li>AUC: (Concordant + 0.5 Tied) / (N1 * N0)</li><li>Gini: 2AUC - 1, or (Concordant - Discordant) / (N1 * N0)</li><li>Goodman-Kruskal Gamma: (Concordant - Discordant) / (Concordant + Discordant), no penalty for Tied</li><li>Kendall&#39;s Tau: (Concordant - Discordant) / (0.5 * (N1+N0) * (N1+N0-1))</li></ul><p>When there are few ties, AUC is the percent of concordant pairs, this is where the name C-statistic or Concordance-statistic came from. The mathematical proof can be found at <a href="https://stats.stackexchange.com/questions/180638/how-to-derive-the-probabilistic-interpretation-of-the-auc">Stack Exchange</a> and <a href="https://pdfs.semanticscholar.org/1fcb/f15898db36990f651c1e5cdc0b405855de2c.pdf">Professor David J. Hand&#39;s article</a>.</p><p>In this package, <code>roc</code> is just a synonym for the <code>concordance</code> function, it returns a named tuple:</p><ul><li><code>conc</code>, number of concordant comparisons</li><li><code>tied</code>, number of tied comparisons</li><li><code>disc</code>, number of discordant comparisons</li><li><code>auc</code>, area under ROC curve, or just area under curve</li><li><code>gini</code>, 2auc - 1</li></ul><h2 id="Fixed-width-tied-region"><a class="docs-heading-anchor" href="#Fixed-width-tied-region">Fixed width tied region</a><a id="Fixed-width-tied-region-1"></a><a class="docs-heading-anchor-permalink" href="#Fixed-width-tied-region" title="Permalink"></a></h2><p>We can use <code>concordance</code> in the more general setting of comparing two  distributions with control over tied definitions.</p><p>Let&#39;s create two weibull distributions,</p><pre><code class="language-julia">using Random
using Distributions
using StatsBase

Random.seed!(123)
w1 = rand(Weibull(1.3, 30_000), 100_000)
w2 = rand(Weibull(1.3, 33_000), 100_000)

mean(w1), mean(w2)</code></pre><pre class="documenter-example-output">(27802.66216348075, 30524.548144849414)</pre><p>If we consider values within +/- 1,000 as ties:</p><pre><code class="language-julia">cls = [fill(0, length(w1)); fill(1, length(w2))]
values = [w1; w2]
c = concordance(cls, values, 1_000)</code></pre><pre class="documenter-example-output">(conc = 5145172789, tied = 318509789, disc = 4536317422, auc = 0.53044276835, gini = 0.060885536700000076)</pre><p>We can compute percentages as follows:</p><pre><code class="language-julia">tot = c.conc + c.tied + c.disc
println(&quot;Concordant %: &quot;, round(c.conc/tot, digits=4),
        &quot;\nTied       %: &quot;, round(c.tied/tot, digits=4),
        &quot;\nDiscordant %: &quot;, round(c.disc/tot, digits=4))</code></pre><pre class="documenter-example-output">Concordant %: 0.5145
Tied       %: 0.0319
Discordant %: 0.4536</pre><p>We can interpret it as, if cls[2] on aggregate has higher value than cls[1], the statement is true concordant% of the time, the statement is neither true or false tied% of the time, the statement is false discordant% of the time. Whereas the simplistic global statement suggests it is true all the time, we now know the extent to which it is true and can argue that it is in fact false discordant% of the time and assess decisions made based on better insights.</p><h2 id="Percentage-tied-range"><a class="docs-heading-anchor" href="#Percentage-tied-range">Percentage tied range</a><a id="Percentage-tied-range-1"></a><a class="docs-heading-anchor-permalink" href="#Percentage-tied-range" title="Permalink"></a></h2><p>Rather than a fixed tied region, it may be appropriate to have variable tied region, e.g., when comparing income, it would be better to use a percentage rather than fixed amount.</p><p>Here&#39;s an example where values within 10% are considered as tied:</p><pre><code class="language-julia">c = concordance(cls, values, x -&gt; (0.9*x, 1.1*x))
tot = c.conc + c.tied + c.disc
println(&quot;Concordant %: &quot;, round(c.conc/tot, digits=4),
        &quot;\nTied       %: &quot;, round(c.tied/tot, digits=4),
        &quot;\nDiscordant %: &quot;, round(c.disc/tot, digits=4))</code></pre><pre class="documenter-example-output">Concordant %: 0.4964
Tied       %: 0.0647
Discordant %: 0.4389</pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../kstest/">« KS Test</a><a class="docs-footer-nextpage" href="../bcdiag/">Plots and Tables »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 8 July 2021 17:17">Thursday 8 July 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
